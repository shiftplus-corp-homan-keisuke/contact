# 問い合わせ管理システム

複数の自社製アプリケーションに対する問い合わせを統合管理するシステムです。問い合わせの受付から回答、FAQ生成まで一元的に管理し、RAG（Retrieval-Augmented Generation）機能を活用して効率的な問い合わせ対応を実現します。

## 主な機能

- **問い合わせ管理**: 複数チャネルからの問い合わせを統合管理
- **回答管理**: 問い合わせに対する回答の記録と履歴管理
- **ベクトル検索**: RAG機能による類似問い合わせの検索
- **FAQ自動生成**: 問い合わせクラスタリングによる自動FAQ生成
- **ユーザー管理**: 役割ベースのアクセス制御
- **通知システム**: リアルタイム通知とアラート機能
- **分析ダッシュボード**: 統計情報とパフォーマンス分析
- **RESTful API**: 外部システム連携用API

## 技術スタック

- **バックエンド**: NestJS + TypeScript + TypeORM
- **データベース**: PostgreSQL (メイン) + Faiss (ベクトル)
- **キャッシュ**: Redis
- **認証**: JWT + bcrypt + Passport.js
- **API仕様**: OpenAPI 3.0 (Swagger)
- **ベクトル化**: OpenAI Embeddings API
- **検索**: ハイブリッド検索（全文検索 + ベクトル検索）

## セットアップ

### 前提条件

- Node.js 18以上
- PostgreSQL 13以上
- Redis 6以上

### インストール

1. 依存関係のインストール
```bash
npm install
```

2. 環境変数の設定
```bash
cp .env.example .env
# .envファイルを編集して適切な値を設定
```

3. データベースのセットアップ
```bash
# データベースの作成
createdb inquiry_management

# マイグレーションの実行
npm run migration:run
```

### 開発サーバーの起動

```bash
# 開発モード
npm run start:dev

# 本番モード
npm run start:prod
```

### テストの実行

```bash
# ユニットテスト
npm run test

# E2Eテスト
npm run test:e2e

# テストカバレッジ
npm run test:cov
```

## API仕様

開発サーバー起動後、以下のURLでSwagger UIにアクセスできます：
- http://localhost:3000/api/docs

## ヘルスチェック

アプリケーションの状態確認：
- http://localhost:3000/health

## プロジェクト構造

```
src/
├── app.module.ts                    # アプリケーションのルートモジュール
├── main.ts                          # アプリケーションエントリーポイント
├── config/                          # 設定ファイル
├── common/                          # 共通機能
│   ├── constants/                   # アプリケーション定数
│   ├── decorators/                  # 共通デコレーター
│   ├── filters/                     # グローバルフィルター
│   ├── interceptors/                # グローバルインターセプター
│   ├── types/                       # 共通型定義
│   ├── utils/                       # 共通ユーティリティ
│   ├── dto/                         # 共通DTO
│   └── entities/                    # 共通エンティティ
└── modules/                         # 機能別モジュール（今後実装予定）
    ├── auth/                        # 認証・認可モジュール
    ├── users/                       # ユーザー管理モジュール
    ├── inquiries/                   # 問い合わせ管理モジュール
    ├── responses/                   # 回答管理モジュール
    ├── search/                      # 検索機能モジュール
    ├── faqs/                        # FAQ管理モジュール
    ├── notifications/               # 通知システムモジュール
    ├── analytics/                   # 分析機能モジュール
    ├── templates/                   # テンプレート管理モジュール
    ├── files/                       # ファイル管理モジュール
    └── api-keys/                    # APIキー管理モジュール
```

## 開発ガイドライン

### コード品質基準
- **可読性**: 明確で理解しやすいコードを書く
- **一貫性**: プロジェクト全体で統一されたスタイルを維持
- **セキュリティ**: セキュリティベストプラクティスを常に適用
- **パフォーマンス**: 効率的で最適化されたコードを心がける

### アーキテクチャ原則
- **単一責任**: 各モジュール・関数は一つの責任のみを持つ
- **疎結合**: コンポーネント間の依存関係を最小限に抑える
- **再利用性**: 共通機能は再利用可能なモジュールとして実装
- **テスタビリティ**: テストしやすい設計を優先

## ライセンス

このプロジェクトは非公開プロジェクトです。